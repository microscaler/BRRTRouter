
// ⚠️ WARNING: This file is auto-generated by BRRTRouter
// ⚠️ DO NOT MODIFY - Changes will be overwritten on next generation
// ⚠️ To modify API behavior, edit the OpenAPI spec and regenerate
// ⚠️ To implement business logic, edit the corresponding controller file
use serde::{Deserialize, Serialize};
use brrtrouter::typed::TypedHandlerRequest;
use brrtrouter::dispatcher::HandlerRequest;
use std::convert::TryFrom;
use crate::handlers::types::Post;


#[derive(Debug, Deserialize, Serialize)]
pub struct Request {
    
    #[serde(rename = "user_id")]
    pub user_id: String,
    
    #[serde(skip_serializing_if = "Option::is_none")] 
    #[serde(rename = "limit")]
    
    pub limit: Option<i32>,
    
    #[serde(skip_serializing_if = "Option::is_none")] 
    #[serde(rename = "offset")]
    
    pub offset: Option<i32>,
    
    }

#[derive(Debug, Serialize)]

pub struct Response(pub Vec<Post>);


impl TryFrom<HandlerRequest> for Request {
    type Error = anyhow::Error;

    fn try_from(req: HandlerRequest) -> Result<Self, Self::Error> {
        use serde_json::{Map, Value};

        let mut data_map = Map::new();

        
        
        if let Some(v) = req.get_path_param("user_id") {
        
            data_map.insert(
                "user_id".to_string(),
                brrtrouter::server::request::decode_param_value(
                    v,Some(&serde_json::json!({"type":"string"})),None,None,
                ),
            );
        } else {
            
            return Err(anyhow::anyhow!("Missing required parameter 'user_id'"));
            
        }
        
        
        if let Some(v) = req.get_query_param("limit") {
        
            data_map.insert(
                "limit".to_string(),
                brrtrouter::server::request::decode_param_value(
                    v,Some(&serde_json::json!({"default":20,"maximum":100,"minimum":0,"type":"integer"})),None,None,
                ),
            );
        } else {
            
            // optional parameter
            
        }
        
        
        if let Some(v) = req.get_query_param("offset") {
        
            data_map.insert(
                "offset".to_string(),
                brrtrouter::server::request::decode_param_value(
                    v,Some(&serde_json::json!({"default":0,"minimum":0,"type":"integer"})),None,None,
                ),
            );
        } else {
            
            // optional parameter
            
        }
        

        if let Some(body) = req.body {
            match body {
                Value::Object(map) => {
                    for (k, v) in map { data_map.insert(k, v); }
                }
                other => {
                    data_map.insert("body".to_string(), other);
                }
            }
        }

        Ok(serde_json::from_value(Value::Object(data_map))?)
    }
}

#[allow(dead_code)]
pub fn handler(req: TypedHandlerRequest<Request>) -> Response {
    crate::controllers::list_user_posts::handle(req)
}